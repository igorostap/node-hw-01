{"ast":null,"code":"import axios from 'axios';\nimport { createAsyncThunk } from '@reduxjs/toolkit';\naxios.defaults.baseURL = 'https://connections-api.herokuapp.com';\nconst token = {\n  set(token) {\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`;\n  },\n\n  unset() {\n    axios.defaults.headers.common.Authorization = '';\n  }\n\n};\nconst register = createAsyncThunk('auth/register', async credentials => {\n  try {\n    const {\n      data\n    } = await axios.post('/users/signup', credentials);\n    token.set(data.token);\n    return data;\n  } catch (error) {}\n});\nconst logIn = createAsyncThunk('auth/login', async credentials => {\n  try {\n    const {\n      data\n    } = await axios.post('/users/login', credentials);\n    token.set(data.token);\n    return data;\n  } catch (error) {}\n});\nconst logOut = createAsyncThunk('auth/logout', async () => {\n  try {\n    await axios.post('/users/logout');\n    token.unset();\n  } catch (error) {}\n});\nconst fetchCurrentUser = createAsyncThunk('auth/refresh', async (_, thunkAPI) => {\n  const state = thunkAPI.getState();\n  const persistedToken = state.auth.token;\n\n  if (persistedToken === null) {\n    console.log('Токена нет, уходим из fetchCurrentUser');\n    return thunkAPI.rejectWithValue();\n  }\n\n  token.set(persistedToken);\n\n  try {\n    const {\n      data\n    } = await axios.get('/users/current');\n    return data;\n  } catch (error) {}\n});\nconst authOperations = {\n  register,\n  logOut,\n  logIn,\n  fetchCurrentUser\n};\nexport default authOperations;","map":{"version":3,"names":["axios","createAsyncThunk","defaults","baseURL","token","set","headers","common","Authorization","unset","register","credentials","data","post","error","logIn","logOut","fetchCurrentUser","_","thunkAPI","state","getState","persistedToken","auth","console","log","rejectWithValue","get","authOperations"],"sources":["/home/ihor/Рабочий стол/goit-react-hw-08-phonebook/src/Redux/auth/auth-operations.js"],"sourcesContent":["import axios from 'axios';\nimport { createAsyncThunk } from '@reduxjs/toolkit';\n\naxios.defaults.baseURL = 'https://connections-api.herokuapp.com';\n\nconst token = {\n  set(token) {\n    axios.defaults.headers.common.Authorization = `Bearer ${token}`;\n  },\n  unset() {\n    axios.defaults.headers.common.Authorization = '';\n  },\n};\n\nconst register = createAsyncThunk('auth/register', async credentials => {\n  try {\n    const { data } = await axios.post('/users/signup', credentials);\n    token.set(data.token);\n    return data;\n  } catch (error) {}\n});\n\nconst logIn = createAsyncThunk('auth/login', async credentials => {\n  try {\n    const { data } = await axios.post('/users/login', credentials);\n    token.set(data.token);\n    return data;\n  } catch (error) {}\n});\n\nconst logOut = createAsyncThunk('auth/logout', async () => {\n  try {\n    await axios.post('/users/logout');\n    token.unset();\n  } catch (error) {}\n});\n\nconst fetchCurrentUser = createAsyncThunk(\n  'auth/refresh',\n  async (_, thunkAPI) => {\n    const state = thunkAPI.getState();\n    const persistedToken = state.auth.token;\n\n    if (persistedToken === null) {\n      console.log('Токена нет, уходим из fetchCurrentUser');\n      return thunkAPI.rejectWithValue();\n    }\n\n    token.set(persistedToken);\n    try {\n      const { data } = await axios.get('/users/current');\n      return data;\n    } catch (error) {}\n  }\n);\n\nconst authOperations = {\n  register,\n  logOut,\n  logIn,\n  fetchCurrentUser,\n};\nexport default authOperations;\n"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,gBAAT,QAAiC,kBAAjC;AAEAD,KAAK,CAACE,QAAN,CAAeC,OAAf,GAAyB,uCAAzB;AAEA,MAAMC,KAAK,GAAG;EACZC,GAAG,CAACD,KAAD,EAAQ;IACTJ,KAAK,CAACE,QAAN,CAAeI,OAAf,CAAuBC,MAAvB,CAA8BC,aAA9B,GAA+C,UAASJ,KAAM,EAA9D;EACD,CAHW;;EAIZK,KAAK,GAAG;IACNT,KAAK,CAACE,QAAN,CAAeI,OAAf,CAAuBC,MAAvB,CAA8BC,aAA9B,GAA8C,EAA9C;EACD;;AANW,CAAd;AASA,MAAME,QAAQ,GAAGT,gBAAgB,CAAC,eAAD,EAAkB,MAAMU,WAAN,IAAqB;EACtE,IAAI;IACF,MAAM;MAAEC;IAAF,IAAW,MAAMZ,KAAK,CAACa,IAAN,CAAW,eAAX,EAA4BF,WAA5B,CAAvB;IACAP,KAAK,CAACC,GAAN,CAAUO,IAAI,CAACR,KAAf;IACA,OAAOQ,IAAP;EACD,CAJD,CAIE,OAAOE,KAAP,EAAc,CAAE;AACnB,CANgC,CAAjC;AAQA,MAAMC,KAAK,GAAGd,gBAAgB,CAAC,YAAD,EAAe,MAAMU,WAAN,IAAqB;EAChE,IAAI;IACF,MAAM;MAAEC;IAAF,IAAW,MAAMZ,KAAK,CAACa,IAAN,CAAW,cAAX,EAA2BF,WAA3B,CAAvB;IACAP,KAAK,CAACC,GAAN,CAAUO,IAAI,CAACR,KAAf;IACA,OAAOQ,IAAP;EACD,CAJD,CAIE,OAAOE,KAAP,EAAc,CAAE;AACnB,CAN6B,CAA9B;AAQA,MAAME,MAAM,GAAGf,gBAAgB,CAAC,aAAD,EAAgB,YAAY;EACzD,IAAI;IACF,MAAMD,KAAK,CAACa,IAAN,CAAW,eAAX,CAAN;IACAT,KAAK,CAACK,KAAN;EACD,CAHD,CAGE,OAAOK,KAAP,EAAc,CAAE;AACnB,CAL8B,CAA/B;AAOA,MAAMG,gBAAgB,GAAGhB,gBAAgB,CACvC,cADuC,EAEvC,OAAOiB,CAAP,EAAUC,QAAV,KAAuB;EACrB,MAAMC,KAAK,GAAGD,QAAQ,CAACE,QAAT,EAAd;EACA,MAAMC,cAAc,GAAGF,KAAK,CAACG,IAAN,CAAWnB,KAAlC;;EAEA,IAAIkB,cAAc,KAAK,IAAvB,EAA6B;IAC3BE,OAAO,CAACC,GAAR,CAAY,wCAAZ;IACA,OAAON,QAAQ,CAACO,eAAT,EAAP;EACD;;EAEDtB,KAAK,CAACC,GAAN,CAAUiB,cAAV;;EACA,IAAI;IACF,MAAM;MAAEV;IAAF,IAAW,MAAMZ,KAAK,CAAC2B,GAAN,CAAU,gBAAV,CAAvB;IACA,OAAOf,IAAP;EACD,CAHD,CAGE,OAAOE,KAAP,EAAc,CAAE;AACnB,CAhBsC,CAAzC;AAmBA,MAAMc,cAAc,GAAG;EACrBlB,QADqB;EAErBM,MAFqB;EAGrBD,KAHqB;EAIrBE;AAJqB,CAAvB;AAMA,eAAeW,cAAf"},"metadata":{},"sourceType":"module"}